from rdkit import Chem
from rdkit.Chem import AllChem
from rdkit.Chem import rdmolfiles, rdmolops

#Morphine to Morphinone or Morphinone to Morphine

# mol = Chem.MolFromSmiles('CN1CC[C@]23[C@@H]4[C@H]1CC5=C2C(=C(C=C5)O)O[C@H]3C(=O)C=C4')

# reaction_smarts = '([#8&v2:1](-[#6&v4:2]1(-[#6&v4:3](=[#6&v4:4](-[#6&v4:5]2(-[#6&v4:6]34-[#6&v4:7]5:[#6&v4:8](-[#8&v2:9]-[#6&v4:10]-3-1-[#1&v1:11]):[#6&v4:12](-[#8&v2:13]-[#6&v4:14](-[#1&v1:15])(-[#1&v1:16])-[#1&v1:17]):[#6&v4:18](:[#6&v4:19](:[#6&v4:20]:5-[#6&v4:21](-[#6&v4:22]-2(-[#7&v3:23](-[#6&v4:24](-[#1&v1:25])(-[#1&v1:26])-[#1&v1:27])-[#6&v4:28](-[#6&v4:29]-4(-[#1&v1:30])-[#1&v1:31])(-[#1&v1:32])-[#1&v1:33])-[#1&v1:34])(-[#1&v1:35])-[#1&v1:36])-[#1&v1:37])-[#1&v1:38])-[#1&v1:39])-[#1&v1:40])-[#1&v1:41])-[#1&v1:42])-[#1&v1:43])>>([#1&+&v0:42].[#7&v3](=[#6&v4](-[#8&v2]-[#1&v1])-[#6&v4]1-[#6&v4](-[#6&v4](=[#6&v4](-[#7&v3](-[#6&v4]=1-[#1&v1])-[#6&v4]1(-[#8&v2]-[#6&v4](-[#6&v4](-[#8&v2]-[#15&v5](=[#8&v2])(-[#8&v2]-[#1&v1])-[#8&v2]-[#15&v5](=[#8&v2])(-[#8&v2]-[#1&v1])-[#8&v2]-[#6&v4](-[#6&v4]2(-[#6&v4](-[#6&v4](-[#8&v2]-[#1&v1])(-[#6&v4](-[#8&v2]-2)(-[#7&v3]2:[#6&v4]3:[#6&v4](:[#7&v3]:[#6&v4]:2-[#1&v1]):[#6&v4](:[#7&v3]:[#6&v4](:[#7&v3]:3)-[#1&v1])-[#7&v3](-[#1&v1])-[#1&v1])-[#1&v1])-[#1&v1])(-[#8&v2]-[#1&v1])-[#1&v1])-[#1&v1])(-[#1&v1])-[#1&v1])(-[#1&v1])-[#1&v1])(-[#6&v4](-[#8&v2]-[#1&v1])(-[#6&v4]-1(-[#8&v2]-[#1&v1])-[#1&v1])-[#1&v1])-[#1&v1])-[#1&v1])-[#1&v1])-[#1&v1])(-[#1&v1])-[#1&v1:43])-[#1&v1].[#8&v2:1]=[#6&v4:2]1-[#6&v4:3](=[#6&v4:4](-[#6&v4:5]2(-[#6&v4:6]34-[#6&v4:7]5:[#6&v4:8](-[#8&v2:9]-[#6&v4:10]-3-1-[#1&v1:11]):[#6&v4:12](-[#8&v2:13]-[#6&v4:14](-[#1&v1:15])(-[#1&v1:16])-[#1&v1:17]):[#6&v4:18](:[#6&v4:19](:[#6&v4:20]:5-[#6&v4:21](-[#6&v4:22]-2(-[#7&v3:23](-[#6&v4:24](-[#1&v1:25])(-[#1&v1:26])-[#1&v1:27])-[#6&v4:28](-[#6&v4:29]-4(-[#1&v1:30])-[#1&v1:31])(-[#1&v1:32])-[#1&v1:33])-[#1&v1:34])(-[#1&v1:35])-[#1&v1:36])-[#1&v1:37])-[#1&v1:38])-[#1&v1:39])-[#1&v1:40])-[#1&v1:41])'

# rxn = AllChem.ReactionFromSmarts(reaction_smarts)

# if rxn.RunReactants((mol,)):
#     print("A regra de reação pode ser aplicada à molécula.")
# else:
#     print("A regra de reação não pode ser aplicada à molécula.")

#L-Dopa to Dopamine


mol = Chem.MolFromSmiles('[NH3+][C@@H](Cc1ccc(O)c(O)c1)C(=O)[O-]')
#C1=CC(=C(C=C1C[C@@H](C(=O)O)N)O)O

reaction_smarts = '([#6&v4:1](-[#6&v4:2])(-[#6&v4:3](-[#7&v3:4](-[#1&v1:5])-[#1&v1:6])(-[#6&v4:7](-[#8&v2:8]-[#1&v1:9])=[#8&v2:10])-[#1&v1:11])(-[#1&v1:12])-[#1&v1:13])>>([#6&v4:1](-[#6&v4:2])(-[#6&v4:3](-[#7&v3:4](-[#1&v1:5])-[#1&v1:6])(-[#1&v1:11])-[#1&v1:9])(-[#1&v1:12])-[#1&v1:13].[#8&v2:8]=[#6&v4:7]=[#8&v2:10])'

new_order = rdmolfiles.CanonicalRankAtoms(mol)
mol = rdmolops.RenumberAtoms(mol, new_order)

rxn = AllChem.ReactionFromSmarts(reaction_smarts)

print(rxn.RunReactants((mol,)))

# if rxn.RunReactants((mol,)):
#     print("A reaction rule pode ser aplicada à molécula.")
# else:
#     print("A reaction rule não pode ser aplicada à molécula.")


